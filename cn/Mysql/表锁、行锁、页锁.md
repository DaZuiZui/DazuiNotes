# 表锁、行锁、页锁

## 表锁

**隔离级别：**在InnoDB默认的的隔离级别是Repeatable read。这个隔离级别下整张表在事物中就会触发表级锁定。

**表的锁定：**使用lock table的时候会锁表

**DDl操作：** 对表使用Alter table、create table这种变更结构的操作会触发表锁。

## 行锁

**隔离级别：**read committed隔离下，innodb会使用行锁。在使用Repreatable read隔离下也会使用行锁，但是事物开启会读取数据快照。

**锁的操作：**使用FOR UPDATE 或者 FOR SHARE也会触发表锁

**事物的操作：**事物执行update和delete的时候会行锁

## 页锁

使用页锁的目标就是减少竞争，提高并发量，当一个事物获取事物的页锁，其他事物想执行，需要等待页锁匙放，这是控制并发机制的一部分需要保证事物的隔离性。

**大范围扫描：**当使用大范围查询会页锁。

**事物的隔离级别：**当使用read committed、read uncommitted的或者select for update 数据库肯呢个会倾向使用页锁保证隔离性。

**索引冲突：**如果多个事物同时尝试修改同一索引的不同部分，可能会使用页锁。



**行锁更合适：**如果我们数据库检测当前页只有少数几行被修改，其他事物需要等待就会转换为行锁，

**减少冲突：**如果我们的页锁导致了较大的锁冲突会考虑降为行锁，减少事物之间的竞争和冲突。

**提升并发性：**为了提高整体的并发量，系统可能会根据实际的情况灵活调整锁的级别。

