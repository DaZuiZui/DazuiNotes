# Spring解决循环依赖

​	Spring解决循环依赖主要有2个解决方案：**提前暴露半成品Bean**、使用**代理对象**

## 提前暴露半成品bean

​	该思想就是通过ObjectFactory和ObjectProvider让我们Bean可以在初始化阶段引用还没初始化完毕的Bean。

​	**1.创建半成品的Bean：**在存在循环依赖的时候，Spring会存在一个半成品Bean，并将它放去提前暴露的Bean列表。半成品的Bean就是已经实列化还没进行初始化。

​	**2.注入早期引用：**其他依赖该半成品Bean的早期引用可以通过ObjectFactory或者ObjectProvider获取。这样Bean就可以在初始化过程中引用还没初始化完毕的Bean，这样就避免的循环依赖

​	**3.完成依赖注入和初始化：**在所有Bean都实列化完毕然后Spring就会处理半成品Bean，并完成依赖注入和初始化的过程。（半成品的Bean会优先初始化和注入）

​	当构造函数循环依赖的时候会使用此方案解决

## 代理对象解决

​	该核心思想就是创建一个代理对象用于提供另一个Bean的引用，代理对象可以延迟目标Bean的实例化以避免延迟依赖/

​    1.当容器在创建Bean得过程中发现循环依赖依赖的时候，它会创建一个代理对象作为临时的引用。

​	2.代理对象暂时代替之前实际的Bean，然后注入到其他需要该Bean的地方。

​	3.容器继续创建其他的Bean，注入他们的依赖

​	4.当所有的Bean完成实例化和初始化后，代理对象会讲实际的Bean对象代替自己，从而解决循环依赖

方法调用的循环依赖会使用这个

## BeanCreationException

当循环依赖无法解决和循环依赖深度限制等其他异常（配置错误，无法解析依赖）会导致**BeanCreationException**

