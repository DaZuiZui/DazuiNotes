# 如何设置核心线程数量

## CPU密集度高

**特点：**主要消耗CPU资源，需要大量的计算和逻辑处理。不会堵塞， 不会因为IO操作或其他堵塞原因导致暂停线程。

所以核心线程数量**CPU核心 + 1**

## IO型任务

**特点：**任务主要消耗在等待IO操作完成上，可能存在堵塞CPU等待IO操作完成。

所以核心线程数量： **2 * CPU核心 + 1**

### 为什么为2 * CPU核心 + 1

主要从

**最大化IO利用率：**  在IO操作的时候，CPU可能会空闲等待IO完成，通过增加线程池的核心线程数，让更多的线程同时执行IO操作，从而提高系统的IO利用率。

**减少IO等待时间：**多个线程可以并发执行IO操作，有助于减少每个线程等待IO操作完成的时间，踢啊高

**保证连续任务执行：**线程堵塞的时候让其他线程上去工作。

总结一句话就是提高CPU使用率，让CPU忙起来。

## 为什么+1？

因为多出来一个线程可用于更加平滑的线程替补，比如有的线程执行完了， 或者休眠中断等，多出来一个线程瞬间出来替补避免CPU空闲。

## 为什么是2*cpu核心+1

其实3*cpu核心+1也是很好的，但是这个根据具体的物理硬件和业务来选择，但是通过经验和性能测试告诉我们，2\* cpu核心+1才是保守的最广泛的，我leader告诉我：开发项目最重要的不是选择什么高端技术也不是像做数学题一样怎么秀怎么来，而是选择最稳定的方案。

