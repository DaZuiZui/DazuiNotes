# 序列化和反序列化

序列化就是把一个对象的状态变成一个一连串的字节。

​	这个字节流可以写到磁盘里。或者在网络中传输。或者存在内存里。

反序列化就是把一个流转换为对象。

## 为什么一定是流

因为Java的IO体系就是围绕流而做的。

输入流

​	输入流 InputStream / Reader

​	输出流 OutputStream / Writer

Java 的 `ObjectOutputStream` 和 `ObjectInputStream` 其实就是在普通的字节流上，封装了对对象的序列化和反序列化逻辑。

~~~java
Object  ----序列化---->  字节流  ----写出---->  文件 / 网络
字节流  ----反序列化-->  Object

~~~

## 什么不能直接用 OutputStream 写对象？

因为普通的 OutputStream 只懂字节，它根本不知道一个对象里面有多少字段、每个字段的类型、如何按一定规则写出/读回来。而 `ObjectOutputStream` 就定义了这样的规则。

## 为什么ObjectOutStream就懂

因为他会先遍历对象里的所有字段。然后会根据字段的一定的协议来写成字节，然后记录元信息，记录对象的结构，确保反序列化的时候能够重建对象。

序列化不仅是简单地把内存里的字节拷贝出来，而是：
 🌟 把对象的结构 + 状态（字段值） + 对象图关系
 按照 Java 序列化协议组织成一份有格式的字节流。