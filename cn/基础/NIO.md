# NIO

NIO是java提供的io操作方式，它提供了更高效的非堵塞io操作，他与传统的io不同的是，传统IO是基于流操作，NIO操作是基于缓冲区和通道进行操作。

NIO通过非堵塞IO来提高IO操作的效率和灵活性。

**通道（channel）：**通道是数据传输的实体，通道可以同时支持读和写操作，也可以是单向的也可以是双向的。

**缓冲区**（buffer）: 缓冲区是一个特定类型数据的容器，他提供了对数据的结构化访问。缓冲区本质是一个数组，可以有效的管理数据。

**选择器（selector）：** 选择器是一个用于多通道的多路复用器，他可以用单个线程管理多个通道，从而提高系统的资源利用率。

NIO不仅可以用在网络编程、文件操作、多路复用，还可以有效的处理大量并发连接和数据操作，提高系统的响应。

NIO的selector使用操作系统的多路复用的模型，也就是说NIO在不同操作系统的表现性能是不一样的，因为不同操作系统的多路复用模型不一样。

## 读的工作流程

创建通道->创建缓存区用于读数据->从通道read方法读数据把数据读到缓存区,如果没有数据可以读了会立刻return->在缓存区处理数据->清理缓存区->关闭通道

## 写的工作流程

创建通道->创建缓存区用户写数据->从通道write方法从缓存区把数据写到通道中，这个是非堵塞的操作，如果通道无法接受数据就立刻返回->清理缓冲区->关闭通道



## **什么是同步、异步、阻塞、非阻塞？**

堵塞：用户进程直到内核数据准备完成才返回。

非堵塞：用户进程不等待内核数据准备完成，立即返回。

同步：用户进程等待数据从内核空间复制到用户空间

异步：用户进程不等待数据复制，内核复制完成后，发送信号通知进程。

## **为何NIO在文件操作中重要**

它可以高效的对大文件进行读取和写入，同时还支持文件随机访问，NIO支持支持内存映射文件，这可以让我们快速的读写操作。	

Tomcat 8及更高版本引入了NIO支持，通过将NIO作为底层的网络处理方式，因为NIO的本质是数组。

## **为何NIO在网络编程中重要**

因为NIO的Selector一个线程可以管理多个通道而不会被任何通道的io操作所堵塞。通过selector可以监视多个通道的就绪状态，当某个通道可以读写该线程会立即处理，提高系统的并发。NIO的缓冲区操作和直接内存访问可以让传输更高效。

## NIO并不是零拷贝

NIO确实提供了零拷贝的操作特性， 例如通过内存映射文件transferto transferfrom方法。