# JVM使用元空间代替了永久代的原因

因为永久代拥有一些限制只要有以下三个方面

## 内存管理灵活性

永久代的内存大小在启动的时候就已经确定了，这就会出现一个问题，如果动态生成类过多可能会导致永久代内存不足。

元空间的大小是动态分配的，他使用的是本地内存，因此更加灵活可以动态增加或者减少。

## 内存溢出角度

永久带在长时间运行可能会出现OutOfMemoryError,因为永久代的内存大小是固定。元空间使用的本机内存不受jvm限制，所以可以灵活的扩大和减少内存。

## 垃圾回收器的角度

永久代的清理需要频繁的FUll GC，会导致我们的程序暂停，但是我们元空间使用的是操作系统进行内存管理

## 操作系统管理内存

### 动态分配

他会动态的更改元空间内存大小

### 内存保护

为了保护元空间的安全性和稳定性，操作系统会采用一些措施来保护元空间内存，比如只读，写保护等，防止非法访问或意外修改元空间数据

### 元空间整理和压缩

因为是动态大小，为了减少内存碎片提高使用率会定期对我们空间进行整理和压缩操作。