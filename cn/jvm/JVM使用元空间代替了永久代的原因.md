# JVM使用元空间代替了永久代的原因

因为永久代拥有一些限制只要有以下三个方面

## 内存管理灵活性

永久代的内存大小在启动的时候就已经确定了，这就会出现一个问题，如果动态生成类过多可能会导致永久代内存不足。

元空间的大小屎动态分配的，他使用的屎本地内存，因此更加灵活可以动态增加或者减少。

## 垃圾回收器的角度

永久代的内存回收是通过Full GC，full GC会暂停我们的应用程序运行。而元空间是通过标记-清除算法的垃圾回收期。可以不暂停我们的程序。

### 标记-清除算法

我们垃圾回收期会遍历整个内存，从根对象（引用的对象）开始，标记所有可以访问到的对象。

然后标记完成结束，垃圾回收期会遍历整个内存，清楚所有未被标记的对象。

当然这个算法也是有缺点的，就是会拥有内存碎片。所以在我们元空间也会使用操作系统提供的虚拟内存管理机制去减少我们的碎片空间。