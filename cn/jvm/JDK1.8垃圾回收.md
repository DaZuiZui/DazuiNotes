# JDK1.8垃圾回收

JDK1.8使用的使用G1垃圾回收器，它将堆分为年轻代、老年代和永久代，该垃圾回收器的目标就是满足低延迟的同时，保持高吞吐量，优势在更加可控的停顿时间，G1会把存活的对象进行标记，没有被标记的对象就会被视为垃圾。

## 分代收集

### 年轻代

​	在对象刚创建后存放的区域，大多数对象都在这里被创建，他们的的生命周期很短，年轻代分为3个区域，1个Eden区和2个Survivor区，新创建的对象会先放到eden区，当发生Minor GC，不会作为垃圾进行回收的对象就会移动到Survivor1区域，在Survivor1的标记不被清理的对象会放在Survior2中，然后清空Survivor1再将Survivor2和Survivor1互换，把1变2把2变1。

### 老年代

该区域的特点就是生命周期较长，在年轻代的对象经历多次Minor GC后还幸存下来那么就会把该对象普升到老年代，老年代的垃圾回收主要是Major GC和Full GC进行回收的，如果我们在创建超大对象的时候也可能放到老年代。

## 垃圾标记

### 初始标记阶段

这个阶段G1会暂停应用程序（STW），标记与根对象直接关联的对象，这个阶段的目的就是创建一个初始标记状态的快照，用于并发阶段的并发工作，这个回收工作会在一个垃圾回收周期开始。

### 并发标记阶段

它是在STW的初始标记阶段之后执行，这个阶段使用一种追踪式标记的方法，通过根对象与其直接引用的对象来标记存货的对象，这个阶段在应用程序继续运行的情况下执行。可以让垃圾回收器和应用程序并发执行。